{% extends 'base.html' %}
{% block title %}
    type-dashboard
{% endblock title %}
{% block content %}
    
<div class="container text-center mb-3">
    <h1 class="display-6">Type DashBoard</h1>
</div>
<div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">
    <form method="post">
        {% csrf_token %}
        <select name="typename" class="form-control" id="formGroupExampleInput" required>
            <option value="">Select a type of Product</option>
            {% for type in types %}

                <option value="{{ type.typename }}"> {{ type.typename }} </option>
                
            {% endfor %}

        </select>
        <div class="text-center">
            <input type="submit" class = "btn btn-primary mt-2 mb-2" value="search">
        </div>
    </form>
</div>
</div>
</div>

{% if type %}
    {% if total_items > 0 %}
    <h1 class="text-center m-3">Showing results for - {{ type.typename }}</h1>

    <table border="2px" class="table table-hover">
        <thead>
            <tr>
                <th>#</th>
                <th>Item name</th>
                <th>Item Type</th>
                <th>Price</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody>
            {% for row in items %}
                <tr onclick="redirect('{{ row.id }}')">
                    <td>{{ forloop.counter }}</td>
                    <td>{{ row.name }}</td>
                    <td>{{ row.item_type }}</td>
                    <td>₹ {{ row.price }}</td>
                    <td>{{ row.quantity }}</td>
                </tr>
            {% endfor %}
            <tfoot>

                <tr>
                    <th colspan="3">Total</th>
                    <th>₹ {{ total_price }}</th>
                    <th>{{ total_items}} Units</th>
                </tr>
            </tfoot>
        </tbody>
    </table>

    {% else %}
    <div class="alert alert-warning alert-dismissible fade show" role="alert">
        <strong>No Stock Left!</strong> {{ type.typename }} is Out of stock.
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endif %}

    <script>
        function redirect(id){
            window.location.href = `/item/${id}`;
        }
    </script>

{% endif %}

{% endblock content %}